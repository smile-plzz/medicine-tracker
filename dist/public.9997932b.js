document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("medicine-form"),t=document.querySelector("#schedule-table tbody"),n=document.getElementById("empty-schedule"),i=document.getElementById("download-pdf");document.getElementById("reset-schedule").addEventListener("click",()=>{confirm("Are you sure you want to clear the entire schedule? This action cannot be undone.")&&(localStorage.removeItem("medicineSchedule"),f=[],h())});let d=document.getElementById("patient-name"),o=document.getElementById("add-time-btn"),a=()=>{let e=document.createElement("div");return e.className="flex items-center mb-2",e.innerHTML=`
            <input type="time" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" name="medicine-time" required>
            <button type="button" class="ml-2 text-red-500" onclick="removeTimeInput(this)">&times;</button>
        `,e};o.addEventListener("click",()=>{document.getElementById("time-inputs").appendChild(a())}),window.removeTimeInput=e=>{e.parentElement.remove()};let l=document.getElementById("medicine-name"),r=document.getElementById("autocomplete-suggestions"),c=(e,t)=>{let n;return(...i)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,i),t)}},m=async e=>{if(e.length<3){r.style.display="none";return}try{let t=await fetch(`https://rxnav.nlm.nih.gov/REST/drugs.json?name=${e}`),n=await t.json(),i=n.drugGroup.drugList.drug?.map(e=>e.name)||[];u(i.slice(0,5))}catch(e){console.error("Failed to fetch suggestions:",e)}},u=e=>{if(0===e.length){r.style.display="none";return}r.innerHTML=e.map(e=>`<div class="p-2 hover:bg-gray-200 cursor-pointer">${e}</div>`).join(""),r.style.display="block"};r.addEventListener("click",e=>{"DIV"===e.target.tagName&&(l.value=e.target.textContent,r.style.display="none")}),l.addEventListener("input",c(async()=>{await m(l.value)},300));let d=document.getElementById("patient-name"),s=document.getElementById("patient-dob"),p=document.getElementById("patient-contact"),g=document.getElementById("patient-allergies"),y=document.getElementById("doctor-name"),v=document.getElementById("doctor-contact"),E=()=>{let e={name:d.value,dob:s.value,contact:p.value,allergies:g.value,doctorName:y.value,doctorContact:v.value};localStorage.setItem("patientInfo",JSON.stringify(e))};d.addEventListener("input",E),s.addEventListener("input",E),p.addEventListener("input",E),g.addEventListener("input",E),y.addEventListener("input",E),v.addEventListener("input",E),(()=>{let e=JSON.parse(localStorage.getItem("patientInfo"));e&&(d.value=e.name||"",s.value=e.dob||"",p.value=e.contact||"",g.value=e.allergies||"",y.value=e.doctorName||"",v.value=e.doctorContact||"")})();let f=JSON.parse(localStorage.getItem("medicineSchedule"))||[],h=()=>{if(t.innerHTML="",0===f.length){n.style.display="block",i.disabled=!0;return}n.style.display="none",i.disabled=!1;let e=[];f.forEach(t=>{t.times.forEach(n=>{e.push({...t,time:n})})}),e.sort((e,t)=>e.time.localeCompare(t.time)).forEach(e=>{let n=document.createElement("tr");n.innerHTML=`
                <td class="border px-4 py-2">${e.time}</td>
                <td class="border px-4 py-2">${e.name}</td>
                <td class="border px-4 py-2">${e.dosage||"N/A"}</td>
                <td class="border px-4 py-2">${e.instructions||"N/A"}</td>
                <td class="border px-4 py-2">${e.info?.genericName||"N/A"}</td>
                <td class="border px-4 py-2">${e.info?.category||"N/A"}</td>
                <td class="border px-4 py-2">${e.info?.usage||"No information available."}</td>
                <td class="border px-4 py-2">
                    <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2" onclick="editMedicine('${e.id}')">Edit</button>
                    <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" onclick="deleteMedicine('${e.id}')">Delete</button>
                </td>
            `,t.appendChild(n)})},b=async(e,t,n,i,d)=>{let o=await I(e),a={id:self.crypto.randomUUID(),name:e,times:t,duration:n,dosage:i,instructions:d,info:o};f.push(a),localStorage.setItem("medicineSchedule",JSON.stringify(f)),h()},I=async e=>{try{let t=await fetch(`https://rxnav.nlm.nih.gov/REST/drugs.json?name=${e}`),n=await t.json();if(n.drugGroup.drugList&&n.drugGroup.drugList.drug){let e=n.drugGroup.drugList.drug[0].rxcui,t=await fetch(`https://rxnav.nlm.nih.gov/REST/rxcui/${e}/allproperties.json?prop=ALL`),i=(await t.json()).propConceptGroup.propConcept,d=i.find(e=>"DEFINITIONAL_FEATURES"===e.propName)?.propValue||"N/A",o=i.find(e=>"Drug Class"===e.propName)?.propValue||"N/A",a=i.find(e=>"RxNorm Name"===e.propName)?.propValue||"N/A";return{usage:d,category:o,genericName:a}}}catch(e){console.error("Failed to fetch medicine info:",e)}return null};window.editMedicine=e=>{let t=f.find(t=>t.id===e);if(t){document.getElementById("medicine-name").value=t.name,document.getElementById("medicine-duration").value=t.duration,document.getElementById("medicine-dosage").value=t.dosage||"",document.getElementById("medicine-instructions").value=t.instructions||"";let n=document.getElementById("time-inputs");n.innerHTML="",t.times.forEach(e=>{let t=a();t.querySelector('input[name="medicine-time"]').value=e,n.appendChild(t)}),deleteMedicine(e)}},window.deleteMedicine=e=>{f=f.filter(t=>t.id!==e),localStorage.setItem("medicineSchedule",JSON.stringify(f)),h()},e.addEventListener("submit",t=>{t.preventDefault();let n=document.getElementById("medicine-name").value,i=Array.from(document.querySelectorAll('input[name="medicine-time"]')).map(e=>e.value).filter(Boolean),d=document.getElementById("medicine-duration").value,o=document.getElementById("medicine-dosage").value,l=document.getElementById("medicine-instructions").value;if(i.length>0){b(n,i,d,o,l),e.reset();let t=document.getElementById("time-inputs");t.innerHTML="",t.appendChild(a())}}),i.addEventListener("click",()=>{let{jsPDF:e}=window.jspdf,t=new e,n=d.value||"Patient",i=s.value,o=p.value,a=g.value,l=y.value,r=v.value;t.text("Medication Schedule",20,20),t.text(`Patient: ${n}`,20,30);let c=40;i&&(t.text(`Date of Birth: ${i}`,20,c),c+=10),o&&(t.text(`Contact: ${o}`,20,c),c+=10),a&&(t.text(`Allergies: ${a}`,20,c),c+=10),l&&(t.text(`Doctor: ${l}`,20,c),c+=10),r&&(t.text(`Doctor Contact: ${r}`,20,c),c+=10),t.text(`Date: ${new Date().toLocaleDateString()}`,20,c);let m=[],u=[];f.forEach(e=>{e.times.forEach(t=>{u.push({...e,time:t})})}),u.sort((e,t)=>e.time.localeCompare(t.time)).forEach(e=>{let t=[e.time,e.name,e.dosage||"N/A",e.instructions||"N/A",e.info?.genericName||"N/A",e.info?.category||"N/A",e.info?.usage||"No information available."];m.push(t)}),t.autoTable(["Time","Medicine","Dosage","Instructions","Generic Name","Category","Description"],m,{startY:c+10}),t.save(`medication_schedule_${new Date().toISOString().slice(0,10)}.pdf`)}),h()});
//# sourceMappingURL=public.9997932b.js.map
